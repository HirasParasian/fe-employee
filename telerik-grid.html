<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link href="https://kendo.cdn.telerik.com/themes/7.0.2/default/default-main.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <script src="https://kendo.cdn.telerik.com/2023.3.1114/js/kendo.all.min.js"></script>
    <script src="/data.js"></script>
    <script src="/data-kota.js"></script>

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
    <style>
        .k-tabstrip-items-wrapper .k-item{
            color: black;
        }
        .k-tabstrip-top > .k-tabstrip-items-wrapper{
            border-bottom-width: 0px;
        }
        .k-tabstrip-items-wrapper .k-item:active, .k-tabstrip-items-wrapper .k-item.k-active, .k-tabstrip-items-wrapper .k-item.k-selected{
            border-color: transparent !important;
        }
        .k-active .btns{
            background-color: #1485EF;
            color: white;
        }
        .bg-gry{
            background-color: #E1E2EA;
        }
        .k-grid .k-grid-header tr:first-child {
            border-bottom: none;
            background-color: #1C1C31;
            color: white;
        }
        tbody .k-grid-table th {
            background-color: #F5F6F6;
            color: black;
        }
        .k-grid .k-table{
            border-width: 1px;
        }
        .k-table-alt-row{
            background-color: transparent !important;
        }
        tbody td {
            border-bottom:1px solid rgba(0, 0, 0, 0.08) !important;
        }
        .k-detail-row{
            background-color: #E1E2EA;
        }
        #tabstrip{
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 2%;
            padding: 10px;
        }
        .k-tabstrip-top > .k-content, .k-tabstrip-top > .k-tabstrip-content{
            border-width: 0px;
        }
        /* border-color: rgba(0, 0, 0, 0.08); */
    </style>
    
    
</head>
<body>
    <div class="row mt-5 container-fluid">
        <h1>Lorem Ipsum</h1>
        <div class="row my-5 container-fluid">
            <div class="col">
                <input id="kd-place-chooser" />
            </div>
            <div class="col">
                <input id="kd-place-chooser2" />
            </div>
            <div class="col">
                <input id="kd-place-chooser3" />
            </div>
            <div class="col">
                <input id="kd-place-chooser4" />
            </div>
            <div class="col">
                <input id="kd-place-chooser5" />
            </div>
            <div class="col">
                <input id="kd-place-chooser6" />
            </div>
            <div class="col">
                <input id="kd-place-chooser7" />
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-2 mt-5">
                <div class="k-form-field-wrap" style="overflow-y: auto; height: 300px;">
                    <ul id="checkboxgroup"></ul>
                </div>
                <div>
                    <button class="btn btn-primary" onclick="filterTable()">Check</button>
                </div>
            </div>
            <div class="col-10">
                <div id="example container-fluid">
                    <div class="demo-section  mx-3">
                        <div id="tabstrip">
                            <ul>
                                <li class="k-active">
                                    <button class="btn btns">
                                        Production Activity
                                    </button>
                                </li>
                                <li>
                                    <button class="btn btns">
                                        Production Support
                                    </button>
                                </li>
                                <li>
                                    <button class="btn btns">
                                        Production Issues
                                    </button>
                                </li>
                            </ul>
                            <div>
                                <div class="mb-3 p-2 bg-gry">
                                    <button class="btn btn-light mx-1"><i class="fa-solid fa-plus"></i> &nbsp;Loading</button>
                                    <button class="btn btn-light mx-1"><i class="fa-solid fa-plus"></i> &nbsp;Hauling</button>
                                </div>
                                <button id="expand" class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>Expand All</span></button>
                                <button id="collapse" class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>Collapse All</span></button>
                                <div id="grid"></div>
                            </div>
                            <div>
                                <span class="sunny">&nbsp;</span>
                                <div class="weather">
                                    <h2>29<span>&ordm;C</span></h2>
                                    <p>Sunny weather in New York.</p>
                                </div>
                            </div>
                            <div>
                                <span class="sunny">&nbsp;</span>
                                <div class="weather">
                                    <h2>21<span>&ordm;C</span></h2>
                                    <p>Sunny weather in London.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var newItem;
        $('#expand').click(function(e){
          var grid = $("#grid").data("kendoGrid");
          $( ".k-master-row" ).each(function( index ) {
            grid.expandRow(this);
          });
        })

        $('#collapse').click(function(e){
          var grid = $("#grid").data("kendoGrid");
          $( ".k-master-row" ).each(function( index ) {
            grid.collapseRow(this);
          });
        })
        var dataTable = DATAX_FIX;
        var dataTables = DATAX_FIX;
        const generateCheckbox = () =>{
            let dataCheckbox = []
            DATAX_FIX.forEach(e => {
                dataCheckbox.push({
                    label:e.loadingEqp,
                    value:e.loadingEqp,
                })
            });
            var checkBoxGroup = $("#checkboxgroup").kendoCheckBoxGroup({
                items: dataCheckbox,
                layout: "vertical",
                //value: ["1", "2"]
            }).data("kendoCheckBoxGroup");

            $("#selectAllCheckbox").change(function () {
                if (this.checked) {
                    checkBoxGroup.checkAll(true)
                } else {
                    checkBoxGroup.checkAll(false)
                }
            });
        }
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && e.key === 's') {
                // Prevent the Save dialog to open
                e.preventDefault();
                // Place your code here
                console.log('CTRL + S');
            }
        });
        function generateTab(){
            $("#tabstrip").kendoTabStrip({
                animation:  {
                    open: {
                        effects: "fadeIn"
                    }
                }
            });
        }
        function dropdownlist_change(e) {
            var value = this.value();
            console.log(value)
            console.log("MHASOOK")
        // Use the value of the widget
        }
        function option(){
            
            var dataSource = new kendo.data.DataSource({
            data: [
                { ID: 1, NAME: "CE6164 - 6020"},
                { ID: 2, NAME: "CE6164 - 6021"},
                { ID: 3, NAME: "CE6164 - 6022"},
                { ID: 4, NAME: "CE6164 - 6023"},
            ],
            sort: { field: "NAME", dir: "asc" }
            });

            $("#kd-place-chooser").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Project ID',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser2").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Daily Plan ID',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser3").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Actual Prod. ID',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser4").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Supervisor',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser5").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Foreman',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser6").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Date',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });

            $("#kd-place-chooser7").kendoDropDownList({
                filter: "contains",
                optionLabel: 'Shift',
                dataTextField: "NAME",
                dataValueField: "ID",
                dataSource: dataSource
            });


            
            $("#tab-app").kendoTabStrip({   
                animation: { open: { effects: "fadeIn" } }
            });
        }
        function onRead2(options) {
            options.success(dataTables);
        }
        var crudServiceBaseUrl = "https://demos.telerik.com/kendo-ui/service"
        function OnUpdate (){
            console.log("UPDATE")
        }
        function OnUpdate2 (){
            console.log("UPDATE2")
        }
        const filterTable = () =>{
            var checkGroup = $("#checkboxgroup").getKendoCheckBoxGroup();
            console.log(checkGroup.value());
            dataTables = DATAX_FIX.filter(e=>{
                if( checkGroup.value().includes(e.loadingEqp)){
                    return e;
                }
            })
            generateTable()
        }
        const generateTable = (data) =>{
            $("#grid").empty()
            //return 0;
            var element = $("#grid").kendoGrid({
                //editable: "incell",
                // dataSource: {
                //     // pageSize: 6,
                //     // serverPaging: true,
                //     // serverSorting: true
                // },
                dataSource : new kendo.data.DataSource({
                    dataType: "jsonp",
                    transport: {
                        //read: "https://demos.telerik.com/kendo-ui/service/Northwind.svc/Employees"
                        read:onRead2,
                        update: OnUpdate2,
                        parameterMap: function(options, operation) {
                            console.log("Mashook")
                            if (operation !== "read" && options.models) {
                                console.log(options)
                                console.log(operation)
                                //return {models: kendo.stringify(options.models)};
                            }
                        }
                    },

                }),
                height: 600,
                scrollable: false,
                // sortable: true,
                // pageable: true,
                detailInit: detailInit,
                dataBound: function() {
                    this.expandRow(this.tbody.find("tr.k-master-row").first());
                },
                columns: [
                    {
                        title: "Loading Equipment",
                        field: "loadingEqp",
                        width: "120px"
                    },
                    {
                        title: "Service",
                        field: "service",
                        width: "120px"
                    },
                    {
                        title: "Operator",
                        field: "operator",
                        width: "120px",
                    },
                    {
                        title: "Foreman",
                        field: "foreman",
                        width: "120px",
                    },
                    {
                        title: "Supervisor",
                        field: "supervisor",
                        width: "120px",
                    },
                    {
                        title: "Location",
                        field: "location",
                        width: "120px",
                    },
                    {
                        title: "Material",
                        field: "material",
                        width: "120px",
                    },
                    {
                        title: "Production",
                        field: "production",
                        width: "120px",
                    },
                    {
                        title: "UOM",
                        field: "uom",
                        width: "110px",
                    },
                    { command: [{
                            name: "Add duplcite row",
                            click: function(e) {
                            // prevent page scroll position change
                            e.preventDefault();
                            // e.target is the DOM element representing the button
                            var tr = $(e.target).closest("tr"); // get the current table row (tr)
                            // get the data bound to the current table row
                            newItem = this.dataItem(tr);
                            dataTable.push(DATAX_FIX[0])
                            console.log("masuk")
                            generateTable()
                            //this.addRow()
                            }
                        }]
                    },
                ]
            });
        }
        $(document).ready(function() {
            generateTab()
            generateCheckbox()
            option()
            
        });
        let idData = ""
        function onRead(options) {
            console.log(dataTable)
            console.log("On Read")
            let filter_data = dataTable.filter(a=>{if(a.loadingEqp == idData){
                return a.data
            }})
            if(filter_data.length){
                options.success(filter_data[0].data);
            }
        }
        //"https://demos.telerik.com/kendo-ui/service/Northwind.svc/Orders"

        var datac =  [
            { OperatorID: "1", OperatorName: "Syaifullah - 11"},
            { OperatorID: "2", OperatorName: "Wijaya Agung - 11"},
        ]

        var bagian =  [
            { OperatorID: "1", OperatorName: "Syaifullah - 11"},
            { OperatorID: "2", OperatorName: "Wijaya Agung - 11"},
        ]
        const ChangeFunction = () =>{
            console.log("Test")
        }
        function clientCategoryEditor(container, options) {
            console.log(options)
            $('<input required name="Operator">')
                .appendTo(container)
                .kendoDropDownList({
                    autoBind: true,
                    filter: "contains",
                    optionLabel: 'Shift',
                    dataTextField: "OperatorName",
                    dataValueField: "OperatorID",
                    change:ChangeFunction,
                    dataSource: {
                        data: datac
                    }
                });
        }
        function ProvinsiEditor(container, options) {
            console.log(options)
            let provinsi = KOTA_DATA.map(e=>{
                return {
                    ProvName: e.provinsi,
                    ProvID: e.provinsi
                }
            })
            $('<input required name="Provinsi">')
                .appendTo(container)
                .kendoDropDownList({
                    autoBind: true,
                    filter: "contains",
                    optionLabel: 'Shift',
                    dataTextField: "ProvName",
                    dataValueField: "ProvID",
                    change:ChangeFunction,
                    dataSource: {
                        data: provinsi
                    }
                });
            console.log(options)
        }
        function KotaEditor(container, options) {
            let provinsi = options.model.Provinsi
            console.log(options.model)
            let kota = KOTA_DATA.filter(e=>{
                if(e.provinsi == provinsi){
                    return e.kota
                }
            })
            let kota_data = kota[0].kota.map(e=>{
                return {
                    KotaName: e,
                    KotaID: e
                }
            })
            $('<input required name="Kota">')
                .appendTo(container)
                .kendoDropDownList({
                    autoBind: true,
                    filter: "contains",
                    optionLabel: 'Shift',
                    dataTextField: "KotaName",
                    dataValueField: "KotaID",
                    change:ChangeFunction,
                    dataSource: {
                        data: kota_data
                    }
                });
            console.log(options)
        }
        const onDataBound = () =>{
            console.log("DATA BOUND")
        }
        function detailInit(e) {
            idData = e.data.loadingEqp
            $("<div  style='width:1000px' />").appendTo(e.detailCell).kendoGrid({
                editable: "incell",
                navigatable: true,
                //groupable: true,
                reorderable: true, // ----- Freez Column Custom
                toolbar: ["create","save"],
                edit:function(){
                    //optionTable()
                },
                dataBound: onDataBound,
                dataSource : new kendo.data.DataSource({
                    batch: true,
                    dataType: "jsonp",
                    transport: {
                        //read: "https://demos.telerik.com/kendo-ui/service/Northwind.svc/Employees"
                        read:onRead,
                        update: function(e){    
                            console.log("update");
                            console.log(e);
                            e.success();
                        },
                        destroy: function(e){    
                            console.log("destroy");
                            console.log(e);
                            e.success();
                        },
                        create: function(e){    
                            console.log("create");
                            console.log(e);
                            e.success();
                        },
                        parameterMap: function(options, operation) {
                            console.log(options)
                            console.log(operation)
                            if (operation !== "read" && options.models) {
                                //return {models: kendo.stringify(options.models)};
                            }
                        }
                    },
                    schema: {
                        model: {
                            id: "haulingEq",
                            fields: {
                                haulingEq: { type: "string" },
                                Operator: { 
                                    defaultValue: {
                                        OperatorID: 8,
                                        OperatorName: "Seafood"
                                    }
                                },
                                Provinsi: { 
                                    defaultValue: {
                                        ProvID: "",
                                        ProvName: ""
                                    }
                                },
                                Kota: { 
                                    defaultValue: {
                                        KotaID: "",
                                        KotaName: ""
                                    }
                                },
                                rit: { type: "string" },
                                cap: { type: "string" },
                                measurement: { type: "string" },
                                mesured: { type: "string" },
                                dest: { type: "string" },
                                distance: { type: "string" },
                                actMeas: { type: "string" },
                                grade: { type: "string" },
                            }
                        }
                    }

                }),
                // dataSource: {
                    

                //     // serverPaging: true,
                //     // serverSorting: true,
                //     // serverFiltering: true,
                //     // pageSize: 10,
                //     //filter: { field: "loadingEqp", operator: "eq", value: e.data.loadingEqp }
                // },
                // sortable: true,
                // pageable: true,
                
                columns: [
                    {   title: "Hauling Eq",
                        field: "haulingEq", 
                        width: "110px",
                        locked: true,
                        lockable: false,
                    },
                    { 
                        title: "Operator",
                        field: "Operator.OperatorName", 
                        width: 180,
                        editor: clientCategoryEditor ,
                    },
                    { 
                        title: "Provinsi",
                        field: "Provinsi", 
                        width: 180,
                        editor: ProvinsiEditor ,
                    },
                    { 
                        title: "Kota",
                        field: "Kota", 
                        width: 180,
                        editor: KotaEditor ,
                    },
                    { title: "Rit",field: "rit", width: "110px" },
                    { title: "Cap",field: "cap", width: "110px" },
                    { title: "Measurement",field: "measurement", width: "110px" },
                    { title: "Measured",field: "measured", width: "110px" },
                    { title: "Dest",field: "dest", width: "110px" },
                    { title: "Distance",field: "distance", width: "110px" },
                    { title: "Act. Meas.",field: "actMeas.", width: "110px" },
                    { title: "Grade",field: "grade", width: "110px" },
                    { command: "destroy", title: "&nbsp;", width: 150 },
                ],
                editable: true
            });
        }

        const changeOption = (obj) =>{
            $(obj)
        }
    </script>




</body>
</html>